<ion-view view-title="Leaderboard" cache-view="false">
  
  <!-- show loading on the top right if loading -->
  <ion-nav-buttons side="right">
    <button class="button button-clear" ng-if="loading">
      <ion-spinner icon="lines" class="dark"></ion-spinner>
    </button>
  </ion-nav-buttons>
  
  <!-- Header bar for different leaderboards -->
  <div class="bar bar-subheader background">
    <div class="tabs">
      <a class="tab-item" ng-click="slideTo(0)"
        ng-class="{active: slide === 0}">Elo Rating</a>    
      <a class="tab-item" ng-click="slideTo(1)"
        ng-class="{active: slide === 1}">Win Percentage</a>
    </div>      
  </div>

  <ion-content class="background has-subheader" has-bouncing="true">
    <!-- pull to refresh -->
    <ion-refresher pulling-text="Pull to refresh..." spinner="lines" on-refresh="getStats()"></ion-refresher>

    <!-- Show if error -->
    <ion-item ng-show="error === true">Can't connect to server :(</ion-item>

    <!-- show loading while waiting -->
    <ion-spinner ng-show="!players && !error" class="loading-dots" icon="lines"></ion-spinner>

    <ion-slide-box on-slide-changed="changeSlide($index)" show-pager="false">

      <!-- ELO Ratings -->
      <ion-slide>
        <ion-list>
          <ion-item 
            class="card"
            ng-repeat="player in players" 
            href="#/app/player/{{player.playerID}}">
            <div class="spaced-out">
              <h2>
                <div class="rank">{{player.rank}}</div> 
                {{player.displayName | capitalize}}
              </h2> 
              <div class="spaced-out">
                <div ng-show="player.disqualified">{{minimumQualified - player.gamesPlayed}} games left to play</div>
                <div ng-show="player.qualified"><b>{{player.elo}}</b></div>
                <div 
                  ng-show="player.qualified && !_.isUndefined(player.dailyChange)"
                  class="elo-change" 
                  ng-class="{'elo-green': player.dailyChange > 0, 'elo-red': player.dailyChange < 0}">
                  {{player.dailyChange | eloChange}}
                </div>
                <div class="ion-ios-arrow-forward" style="padding-left:16px"></div>
              </div>
            </div>
            <!-- <div class="progress" ng-show="player.qualified">
              <div class="progress-bar" style="width: {{player.winRate *  100 | number}}%">
                <div style="text-shadow: 1px 1px #000000;">{{player.winRate * 100 | number:1}}%</div>
              </div>
            </div> -->
          </ion-item>
        </ion-list>
      </ion-slide>

      <!-- % Games won -->
      <ion-slide>
        <ion-item 
          class="card"
          ng-repeat="player in players"
          href="#/app/player/{{player.playerId}}">
          <div class="spaced-out">
            <h2>
              <div class="rank">{{$index + 1}}</div> 
              {{player.displayName | capitalize}}
            </h2> 
            <div class="spaced-out">
              <b>{{player.winRate * 100 | number:1}}%</b>
              <div class="ion-ios-arrow-forward" style="padding-left:16px"></div>
            </div>
          </div>
        </ion-item>
      </ion-slide>

    </ion-slide-box>
  </ion-content>
</ion-view>